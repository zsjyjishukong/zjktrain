<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>后台管理</title>
    <link rel="stylesheet" href="jquery-ui.css">
    <style>
        .left-border{
            /*border-bottom: 1px solid #aeaeae;*/
            padding: 0 5px;
        }
        #accordion>div{
            overflow: hidden;
        }
        .nav-manage{
            text-align: center;
        }
        #nav-manage-table{
            margin: auto;
        }
        #nav-manage-table tr{
            height: 30px;
        }
        #nav-manage-table input{
            -webkit-border-radius: 5px;
            -moz-border-radius: 5px;
            border-radius: 5px;
            outline-color: orange;
            -moz-outline-radius: 5px;
            padding: 2px 5px;
        }
        .head-img-manage{
            text-align: center;
        }
        .middle-img{
            text-align: center;
        }
        .middle-img>table{
            margin: auto;
        }
        .middle-img td{
            padding: 5px 20px;
        }
        .safe-manage{
            text-align: center;
        }
        .safe-manage>table{
            margin: auto;
        }
        .safe-manage td{
            padding: 5px 30px;
        }
        .links-manage{
            text-align: center;
        }
        .links-manage table{
            margin: auto;
        }
        .links-manage td {
            padding: 5px 20px;
        }
        .column-title-manage{
            text-align: center;
        }
        .column6-manage{
            text-align: center;
        }
        .admin-manage{
            text-align: center;
        }
        table{
            margin: auto;
        }
        td{
            padding: 5px 20px;
        }
    </style>
</head>
<body>
<div id="accordion">
    <h3>导航管理</h3>
    <div class="nav-manage">
        <table style="text-align: center" id="nav-manage-table">
            <tr>
                <td>显示顺序</td>
                <td class="left-border">显示文字</td>
                <td class="left-border">跳转链接</td>
            </tr>
            <tr>
                <td>1</td>
                <td class="left-border"><input type="text" class="nav" name="nav1_description"></td>
                <td class="left-border"><input type="text" class="nav" name="nav1_src" ></td>
            </tr>

            <tr>
                <td>2</td>
                <td class="left-border"><input type="text" class="nav" name="nav2_description"></td>
                <td class="left-border"><input type="text" class="nav" name="nav2_src"></td>
            </tr>

            <tr>
                <td>3</td>
                <td class="left-border"><input type="text" class="nav" name="nav3_description"></td>
                <td class="left-border"><input type="text" class="nav" name="nav3_src"></td>
            </tr>

            <tr>
                <td>4</td>
                <td class="left-border"><input type="text" class="nav" name="nav4_description"></td>
                <td class="left-border"><input type="text" class="nav" name="nav4_src"></td>
            </tr>
            <tr>
                <td>5</td>
                <td class="left-border"><input type="text" class="nav" name="nav5_description"></td>
                <td class="left-border"><input type="text" class="nav" name="nav5_src"></td>
            </tr>
            <tr>
                <td>6</td>
                <td class="left-border"><input type="text" class="nav" name="nav6_description"></td>
                <td class="left-border"><input type="text" class="nav" name="nav6_src"></td>
            </tr>
            <tr>
                <td>7</td>
                <td class="left-border"><input type="text" class="nav" name="nav7_description"></td>
                <td class="left-border"><input type="text" class="nav" name="nav7_src"></td>
            </tr>
        </table><br>
        <button>确认更改</button>
    </div>
    <h3>头图管理</h3>
    <div class="head-img-manage">
        <img src="../img/head.jpg" width="960px"><br><br>
        <span style="color: #aeaeae;">* 推荐1920*570像素的图片</span><br><br>
        <button>确认更换</button>
    </div>
    <h3>中轮播管理</h3>
    <div class="middle-img">
        <table>
            <tr>
                <td>序号</td>
                <td>图片</td>
                <td>操作</td>
            </tr>
            <tbody>

            </tbody>
        </table>
        <br>
        <span style="color: #aeaeae;">* 推荐603*450像素的图片</span><br><br>
        <button>确认更换</button>
    </div>
    <h3>安全日历管理</h3>
    <div class="safe-manage">
        <table>
            <tr>
                <td>序号</td>
                <td>描述</td>
                <td>日期</td>
            </tr>
            <tbody>
                <tr>
                    <td>1</td>
                    <td>本段</td>
                    <td><input id="local" class="date"></td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>路局</td>
                    <td><input id="origin" class="date"></td>
                </tr>
            </tbody>
        </table><br>
        <button>确认更改</button>
    </div>
    <h3>友情链接管理</h3>
    <div class="links-manage">
        <table>
            <tr>
                <th>序号</th>
                <th>显示文字</th>
                <th>跳转链接</th>
            </tr>
            <tbody>

            </tbody>
        </table>
        <button>确认更改</button>
    </div>
    <h3>栏目标题管理</h3>
    <div class="column-title-manage">
        <table>
            <tr>
                <th>序号</th>
                <th>显示文字</th>
            </tr>
            <tbody>

            </tbody>
        </table>
        <button>确认更改</button>
    </div>
    <h3>栏目1内容管理<span class="column-title"></span></h3>
    <div class="column1-manage">
        <table>
            <tr>
                <th>序号</th>
                <th>标题</th>
                <th>时间</th>
            </tr>
            <tbody>

            </tbody>
        </table>
    </div>
    <h3>栏目2内容管理<span class="column-title"></span></h3>
    <div class="column2-manage">
        <table>
            <tr>
                <th>序号</th>
                <th>标题</th>
                <th>时间</th>
            </tr>
            <tbody>

            </tbody>
        </table>
    </div>
    <h3>栏目3内容管理<span class="column-title"></span></h3>
    <div class="column3-manage">
        <table>
            <tr>
                <th>序号</th>
                <th>标题</th>
                <th>时间</th>
            </tr>
            <tbody>

            </tbody>
        </table>
    </div>
    <h3>栏目4内容管理<span class="column-title"></span></h3>
    <div class="column4-manage">
        <table>
            <tr>
                <th>序号</th>
                <th>标题</th>
                <th>时间</th>
            </tr>
            <tbody>

            </tbody>
        </table>
    </div>
    <h3>栏目5内容管理<span class="column-title"></span></h3>
    <div class="column5-manage">
        <table>
            <tr>
                <th>序号</th>
                <th>标题</th>
                <th>时间</th>
            </tr>
            <tbody>

            </tbody>
        </table>
    </div>
    <h3>栏目6内容管理<span class="column-title"></span></h3>
    <div class="column6-manage">
        <table>
            <tr>
                <th>序号</th>
                <th>图片</th>
                <th>操作</th>
            </tr>
            <tbody>

            </tbody>
        </table>
        <br>
        <span style="color: #aeaeae;">* 推荐603*450像素的图片</span><br><br>
        <button>确认更换</button>
    </div>
    <h3>管理员管理</h3>
    <div class="admin-manage">
        <table>
            <tr>
                <th>序号</th>
                <th>名称</th>
                <th>操作</th>
            </tr>
            <tbody>

            </tbody>
        </table>
    </div>
</div>
</body>
<script src="external/jquery/jquery.js"></script>
<script src="jquery-ui.js"></script>
<script>
    $.ajax({
        url: '../php/index_init.php',
        methods: 'get',
        success: function (res) {
            res = JSON.parse(res)
            if (res.code === 0) {
                let data = res.data
                // 改变nav
                let navs = $(".nav-manage input")
                for (let i = 0; i<navs.size()/2; i++) {
                    navs.eq(2*i).val(data.navs[i].description)
                    navs.eq(2*i+1).val(data.navs[i].src)
                }

                // 读取中间轮播图片
                let middle = $(".middle-img tbody").eq(0)
                for (let i =0; i<data.middleImg.length; i++) {
                    let $newMiddle = $(`<tr>
                                             <td>${i+1}</td>
                                             <td><img src="../${data.middleImg[i].src}" height='100px'></td>
                                             <td><button>删除</button></td>
                                         </tr>`)
                    middle.append($newMiddle)
                }

                // 操作safe
                let safeLocal = data.safe[0].dates
                $('#local').val(safeLocal)
                let safeOrigin = data.safe[1].dates
                $('#origin').val(safeOrigin)

                // 显示友情链接
                for (let i = 0; i < data.link.length; i++) {
                    let $newHtml = $(`<tr>
                                        <td>${i + 1}</td>
                                        <td><input type='text' value='${data.link[i].description}'> </td>
                                        <td><input type='text' value='${data.link[i].src}'></td>
                                    </tr>`)
                    $(".links-manage tbody").eq(0).append($newHtml)
                }

                // 显示栏目标题
                for (let i = 0; i < data.columnTitle.length; i++) {
                    let $newHtml = $(`<tr>
                                        <td>${i + 1}</td>
                                        <td><input type='text' value='${data.columnTitle[i].description}'> </td>
                                    </tr>`)
                    $(".column-title-manage tbody").eq(0).append($newHtml)
                }

                // 显示标题
                for (let i = 0; i < data.columnTitle.length; i++) {
                    $(".column-title").eq(i).html("----" + data.columnTitle[i].description)
                }

                // 栏目1显示
                let column1 = $(".column1-manage tbody").eq(0)
                for (let i = 0; i < data.column1.length; i++) {
                    column1.append($(`<tr>
                                        <td>${i + 1}</td>
                                        <td><input type="text" value="${data.column1[i].title}"></td>
                                        <td><input type="text" value="${data.column1[i].date}" </td>
                                    </tr>`))
                }

                // 栏目2显示
                let column2 = $(".column2-manage tbody").eq(0)
                for (let i = 0; i < data.column2.length; i++) {
                    column2.append($(`<tr>
                                        <td>${i + 1}</td>
                                        <td><input type="text" value="${data.column2[i].title}"></td>
                                        <td><input type="text" value="${data.column2[i].date}" </td>
                                    </tr>`))
                }

                // 栏目3显示
                let column3 = $(".column3-manage tbody").eq(0)
                for (let i = 0; i < data.column3.length; i++) {
                    column3.append($(`<tr>
                                        <td>${i + 1}</td>
                                        <td><input type="text" value="${data.column3[i].title}"></td>
                                        <td><input type="text" value="${data.column3[i].date}" </td>
                                    </tr>`))
                }

                // 栏目4显示
                let column4 = $(".column4-manage tbody").eq(0)
                for (let i = 0; i < data.column4.length; i++) {
                    column4.append($(`<tr>
                                        <td>${i + 1}</td>
                                        <td><input type="text" value="${data.column4[i].title}"></td>
                                        <td><input type="text" value="${data.column4[i].date}" </td>
                                    </tr>`))
                }

                // 栏目5显示
                let column5 = $(".column5-manage tbody").eq(0)
                for (let i = 0; i < data.column5.length; i++) {
                    column5.append($(`<tr>
                                        <td>${i + 1}</td>
                                        <td><input type="text" value="${data.column5[i].title}"></td>
                                        <td><input type="text" value="${data.column5[i].date}" </td>
                                    </tr>`))
                }
                // 栏目六显示
                let column6 = $(".column6-manage tbody").eq(0)
                for (let i =0; i<data.column6.length; i++) {
                    let $newMiddle = $(`<tr>
                                             <td>${i+1}</td>
                                             <td><img src="../${data.column6[i].img_src}" height='100px'></td>
                                             <td><button>删除</button></td>
                                         </tr>`)
                    column6.append($newMiddle)
                }
            }
            $("button").button()
        },
        error: function (err) {
            console.log('出错了'+err)
        }
    })

    //admin 请求
    $.ajax({
        url: 'php/adminList.php',
        methods: 'get',
        success: function (res) {
            res = JSON.parse(res)
            if (res.code === 0) {
                for (let i = 0; i< res.data.adminList.length; i++) {
                    $('.admin-manage tbody').eq(0).append($(`<tr><td>${i + 1}</td><td>${res.data.adminList[i].admin_name}</td><td><button>删除</button></td></tr>`))
                }
            $('button').button();
            } else {
                alert('返回出错');
            }
        },
        error: function (err) {
            alert('请求出错');
        }
    })
    $(".date").datepicker({
        showOtherMonths: true,
        selectOtherMonths: true,
        changeMonth: true,
        changeYear: true,
        dateFormat: "yy-mm-dd"
    })
    $( "#accordion" ).accordion({
        heightStyle: "content"
    });
    $("#nav-manage-table tr:lt(1) td:lt(1)").css("padding", "5px")
    $("button").button()
</script>
</html>